// -*- go -*-
//
// Copyright (c) 2020 Markku Rossi
//
// All rights reserved.
//

package math

// Exp computes b**e mod |m| (i.e. the sign of m is ignore).
// TODO, use wildcard types: Exp(b, e, n uint<T>) uint<T>
func Exp(b, e, m uint64) uint64 {
	var r uint64 = 1

	for i := size(b) - 1; i >= 0; i = i - 1 {
		r = r * r % m
		if e>>i&1 != 0 {
			r = r * b % m
		}
	}

	return r
}
